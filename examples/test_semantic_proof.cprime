// Clean test to prove both semantic functionalities
exec footer_replacer<value> {
    -- Footer replacement: simple code generation
    local val = params[0] or "DEFAULT"
    return "int footer_result = " .. val .. ";"
}

exec scope_analyzer<analysis_type> {
    -- Header template: analyze scope content 
    local scope_content = params[0]  -- Detokenized scope
    local analysis = params[1] or "basic"
    
    -- Count int variables in scope
    local int_count = 0
    for _ in string.gmatch(scope_content, "int%s+%w+") do
        int_count = int_count + 1
    end
    
    return "int analysis_result = " .. int_count .. "; // Found " .. int_count .. " int vars"
}

// Test 1: Footer exec - scope replacement
exec <value> {
    return "string footer_replaced = \"Footer exec worked!\";"
}<123>

// Test 2: Header exec - template analysis  
if scope_analyzer<detailed> {
    int var1 = 10;
    int var2 = 20;
    print("This scope has variables");
}

int main() {
    return 0;
}